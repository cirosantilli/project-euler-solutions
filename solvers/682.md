# Project Euler 682 Solution - $5$-Smooth Pairs

<https://projecteuler.net/problem=682>:

* [682.py](682.py)

This solution computes **f(10⁷) mod 1,000,000,007** without enumerating Hamming numbers.

## Key ideas

### 1) Encode Hamming numbers with a bivariate generating function
A 5-smooth (Hamming) number has the form `2^a 3^b 5^c`.

- `Ω = a + b + c` (number of prime factors, with multiplicity)
- `s = 2a + 3b + 5c` (sum of prime factors, with multiplicity)

Introduce a generating function that tracks both quantities:

\[
F(y,x)=\sum_{a,b,c\ge 0} (y x^2)^a (y x^3)^b (y x^5)^c
      =\frac{1}{(1-yx^2)(1-yx^3)(1-yx^5)}
\]

The coefficient of `y^k x^m` counts Hamming numbers with `Ω = k` and `s = m`.

### 2) Convert the “equal Ω” pair-count into a constant-term extraction
Let `A_k(x)` be the coefficient of `y^k` in `F(y,x)`.

The required count for each `n` is:

\[
f(n) = [x^n]\sum_{k\ge 0} A_k(x)^2
\]

Using the identity

\[
\sum_k A_k(x)^2 = [y^0]\;F(y,x)\,F(1/y,x)
\]

we transform the problem into taking the **constant term in `y`** of a rational function.

### 3) Evaluate the constant term via residues (formal power series)
After rewriting `F(y,x)F(1/y,x)` as a rational function in `y`, only the “small” poles
(in terms of `x`) contribute to the constant term. Here those poles are at:

- `y = x^2`, `y = x^3`, `y = x^5`

Summing the residues yields a **rational function in `x`**:

\[
S(x)=\frac{P(x)}{Q(x)}
\quad\text{where}\quad
f(n)=[x^n]S(x)
\]

The code constructs `P(x)` and `Q(x)` from compact factor lists (products of polynomials like `1-x^k`).

### 4) Extract the nth coefficient with Bostan–Mori
To compute `[x^n] P(x)/Q(x)` efficiently, the implementation uses the **Bostan–Mori algorithm**,
which repeatedly halves `n` while updating `(P,Q)` using the transformation with `Q(-x)` and
even/odd coefficient splitting.

- Time: `O(d^2 log n)` with naive multiplication (here `d` is small)
- Memory: `O(d)`

## What the program does
- Builds `P(x)` and `Q(x)` modulo `1,000,000,007`
- Asserts the two test values from the statement (`f(10)` and `f(100)`)
- Prints `f(10^7) mod 1,000,000,007`
