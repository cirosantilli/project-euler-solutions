# Project Euler 708 Solution - Twos Are All You Need

<https://projecteuler.net/problem=708>:

* [708.py](708.py)

## Key idea
Let `f(n) = 2^{Omega(n)}`. Using Euler products,
`f = d * g` (Dirichlet convolution), where `d(n)` is the divisor function and
`g(p^1) = 0`, `g(p^k) = 2^{k-2}` for `k >= 2`.  
Therefore:

```
S(N) = sum_{n<=N} f(n) = sum_{b<=N} g(b) * D(N/b)
```

with `D(x) = sum_{n<=x} d(n)` the divisor summatory function.

## Computing `D(x)`
Use the classic formula:

```
D(x) = 2 * sum_{i=1..floor(sqrt(x))} floor(x / i) - floor(sqrt(x))^2
```

Small `x` values are precomputed with a smallest-prime-factor sieve and prefix
sum of `d(n)` to avoid repeated work. Larger `x` values are memoized.

## Enumerating `g(b)`
`g(b)` is nonzero only for **powerful numbers** (all prime exponents >= 2).
Enumerate these by DFS over primes with exponents starting at 2.  
For a prime `p`, the contribution factor for exponent `e` is `2^{e-2}`, so the
DFS keeps the current product `g(b)` and multiplies by 2 each time the exponent
is increased.

## Final assembly
For each powerful number `b`, accumulate `g(b) * D(N/b)`.  
This yields `S(N)` quickly enough for `N = 10^14` while remaining exact.
