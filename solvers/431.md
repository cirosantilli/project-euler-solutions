# Project Euler 431 Solution - Square Space Silo

<https://projecteuler.net/problem=431>:

* [431.py](431.py)

This solution computes the horizontal offsets `x` (in meters) for which the **wasted volume** inside a cylindrical silo is an **integer square**, then prints `sum(x)` to 9 decimal places.

## Key ideas used

### 1) Geometry → an integral of distance
For a granular material with angle of repose `α`, the surface height drop equals:

`height = tan(α) * (horizontal distance from the delivery point)`

So the wasted (empty) volume above the grain surface is:

`V(x) = tan(α) * ∬_disk dist(P, apex) dA`

where the disk is the silo top (radius `R`) and the apex is offset by `x` from the disk center.

### 2) Polar coordinates centered at the apex
Switch to polar coordinates around the apex. Along a ray angle `θ`, the ray intersects the circle at a radius

`r_max(θ) = -x cos θ + sqrt(R^2 - x^2 sin^2 θ)`  (for `0 ≤ x ≤ R`)

In these coordinates, `dist = r` and `dA = r dr dθ`, so:

`I(x) = ∬_disk r dA = ∫∫ r * r dr dθ = (1/3) ∫ r_max(θ)^3 dθ`

Using symmetry, this becomes:

`I(x) = (2/3) ∫_0^π r_max(θ)^3 dθ`

and therefore:

`V(x) = tan(α) * I(x)`

So the 2D area integral reduces to a **single 1D integral** over `θ`.

### 3) High-accuracy numerical integration (Gauss–Legendre)
The remaining integral is smooth, so fixed-order **Gauss–Legendre quadrature** gives high accuracy with a small number of function evaluations. The code computes nodes/weights on `[-1,1]` using Newton’s method on Legendre polynomial roots, then maps them onto `[0, π]`.

### 4) Monotonic root-finding (bisection)
`V(x)` increases with `x` on `[0, R]`, so for each integer square `n²` in `[V(0), V(R)]` there is at most one solution. Each `x` is found with **bisection**, which is robust and easy to implement.

### 5) Built-in statement checks
The example numeric values from the problem statement are asserted:
- For `R=3`, `α=30°`: `V(0) ≈ 32.648388556`
- `V(1.114785284) ≈ 36`
- `V(2.511167869) ≈ 49`

## Running

```bash
python3 main.py
```

It prints the required `sum(x)` for `R=6` and `α=40°` formatted to 9 decimal places.
