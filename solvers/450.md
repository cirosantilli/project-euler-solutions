# Project Euler 450 Solution - Hypocycloid and Lattice Points

<https://projecteuler.net/problem=450>:

* [450.py](450.py)

This solution computes `T(N)` for `N = 10^6` using **integer arithmetic only** (no floating point, no external libraries).

## Key transformations

The hypocycloid can be re-parameterized with:

- `A = R - r`, `B = r`  (so `R = A + B`)
- `u = t / r`

Then the curve becomes:

- `x(u) = A cos(Bu) + B cos(Au)`
- `y(u) = A sin(Bu) - B sin(Au)`

The problem restricts to points where `sin(t)` and `cos(t)` are rational; in this re-parameterization that means `sin(Bu)` and `cos(Bu)` are rational.  
For lattice points, the integer-coordinate requirement forces the other trig terms to be rational too.

Let `d = gcd(A, B)` and write `A = d*A'`, `B = d*B'` with `gcd(A', B') = 1`.  
All rationality constraints then reduce to requiring that `cos(t0)` and `sin(t0)` are rational for `t0 = d*u`.

Rational points on the unit circle are exactly primitive Pythagorean triples:

- `cos(t0) = a/c`, `sin(t0) = b/c`, where `a^2 + b^2 = c^2` and `gcd(a,b,c)=1`.

## Splitting into two disjoint cases

### 1) The dominant case: `c = 1` (axis-aligned angles)

When `c = 1`, the only possibilities are `t0` multiples of `π/2`, so all needed sines/cosines are in `{0, ±1}`.
This yields a small fixed family of lattice points for each coprime pair `(A', B')`, and the total
contribution becomes a **linear form** in `A'` and `B'` with a couple of parity/mod-4 corrections.

To sum this over all coprime pairs with `A' > B'` and `A' + B' <= M`, we use:

- **Möbius inversion** to enforce `gcd(A',B')=1`
- **closed-form polynomial sums** for the triangular region `A' > B'`, `A' + B' <= M`
- the standard **floor-division blocking trick** to evaluate
  sums like `Σ μ(d)*d*F(⌊M/d⌋)` in `O(√M)` time.

Finally, to lift from coprime `(A',B')` to all `(A,B)` we sum over possible `d` using another floor-blocked divisor sum:
`Σ d * f(⌊N/d⌋)`.

### 2) The rare case: `c > 1` (non-axis rational angles)

For `c > 1`, denominators grow as powers of `c` in `cos(k t0)` and `sin(k t0)`. This heavily constrains which
pairs `(A',B')` can contribute under `A + B <= N`, so only small `A'` are possible for `N = 10^6`.

We enumerate primitive Pythagorean triples `(a,b,c)` via Euclid’s formula (with `c` odd),
and compute the needed trig multiples using **Gaussian integer exponentiation**:

- `(a + i b)^k = u_k + i v_k`
- `cos(k t0) = u_k / c^k`, `sin(k t0) = v_k / c^k`

The lattice-point integrality condition becomes a pure divisibility problem, handled by
taking a `gcd` against `c^{A'}` to find the **minimal scaling** that makes coordinates integral.
All larger valid circles simply scale the point, so their total contribution is computed with a triangular-number sum.

## Correctness checks

The code includes assertions for all example values listed in the problem statement, including:

- the explicit sets `C(3,1)` and `C(2500,1000)`
- `S(3,1) = 10`
- `T(3)`, `T(10)`, `T(100)`, and `T(10^3)`

Run `python3 main.py` to print `T(10^6)`.
