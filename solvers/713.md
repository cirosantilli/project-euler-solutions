# Project Euler 713 Solution - Turán's Water Heating System

<https://projecteuler.net/problem=713>:

* [713.py](713.py)

## Key ideas

### 1) Reformulate the “fuse tests” as a graph problem
- There are `N` fuses (vertices).
- Exactly `m` are working (good vertices), but we don’t know which.
- A “try” is choosing a pair of fuses (querying an edge). The system turns on **iff** both endpoints are good.

To **guarantee** success, we must choose tests so that **every** possible set of `m` good fuses contains at least one tested pair.

That means: the graph of tested edges has **no independent set of size `m`** (otherwise those `m` good vertices could avoid all tested edges).

### 2) Turán’s theorem gives the optimal `T(N, m)`
Minimizing the number of tested edges subject to “independence number `< m`” is equivalent (via graph complement) to maximizing the number of edges in a graph with **no clique of size `m`**.

By **Turán’s theorem**, the maximum number of edges in an `N`-vertex graph with no `K_m` is achieved by the balanced `(m-1)`-partite Turán graph.

Therefore the optimal tested-edge set is the **complement** of that Turán graph:
- Split `N` vertices into `k = m-1` parts as evenly as possible.
- Test all pairs **within** each part (a disjoint union of cliques).
- The number of tests is the sum of `C(part_size, 2)`.

This yields a direct formula for `T(N, m)`.

### 3) Fast summation for `L(N)`
We need:

`L(N) = sum_{m=2..N} T(N, m)`.

Let `k = m-1` and `q = floor(N/k)`. After simplifying the closed form, each term depends on `q = floor(N/k)` and on `k` linearly.

The classic trick is to iterate `k` in ranges where `floor(N/k)` is constant:
- For a fixed `q`, all `k` in `[k_min, k_max]` share the same quotient.
- Over that range, the sum becomes a combination of:
  - `count` of terms
  - an arithmetic series `sum(k)`

This reduces the runtime to about `O(sqrt(N))` iterations.

## What the program does
- Implements `T(N, m)` from the balanced-partition (Turán complement) formula.
- Computes `L(10^7)` using divisor-summatory grouping in `O(sqrt(N))`.
- Includes `assert` checks for the sample values given in the problem statement.
