# Project Euler 576 Solution - Irrational Jumps

<https://projecteuler.net/problem=576>:

* [576.py](576.py)

This repository contains a standalone Python solution (`main.py`) for Project Euler problem 576.

## Key ideas

### 1) Turn “first hit” into an interval-minimum problem
After `k` jumps of length `l` the landing point is:

- `x_k = frac(k·l)` on the circle.

The gap is the interval `[d, d+g)` (with `d+g < 1`).  
The `k`‑th landing point falls into the gap iff:

- `d ∈ (x_k - g, x_k]`.

So for a fixed `d`, the hitting time is simply:

- `K(d) = min { k ≥ 1 : d ∈ (x_k - g, x_k] }`,
- `S(l,g,d) = l · K(d)`.

This reframes the problem as: **for every `d`, find the minimum label `k` among all intervals that cover it**.

### 2) Discretize by interval endpoints
All interval boundaries are of the form:

- `x_k` and `x_k - g` (clipped to `[0, 1-g]`).

Between any two consecutive boundaries, the set of covering intervals is constant, so `K(d)` and `S(l,g,d)` are constant as well.  
That means we only need to evaluate on these elementary cells.

### 3) Fast “interval painting” with DSU (disjoint set union)
We process intervals in increasing `k`.  
When painting an interval `[i, j)` over the discretized cells:

- if a cell is unassigned, its minimum `k` must be the current `k`,
- if it’s already assigned, we skip it.

To skip quickly, we use a DSU / “next-unassigned” structure:

- `find(i)` returns the next unassigned cell index ≥ `i`,
- when assigning cell `t`, we set `parent[t] = t+1`.

Total work per prime is near-linear in the number of discretized cells.

### 4) Merge piecewise-constant functions to maximize the sum
For `M(n,g)` we sum `S(1/√p, g, d)` over all primes `p ≤ n` and choose `d` maximizing the sum.

Each prime produces a piecewise-constant function of `d`.  
We merge all segment boundaries with a small min-heap (one pointer per prime) and track the running total, updating the maximum as we sweep across `d ∈ [0, 1-g)`.

## Output
Running `python3 main.py` prints `M(100, 0.00002)` rounded to 4 decimals, and includes asserts for all numeric examples given in the problem statement.
