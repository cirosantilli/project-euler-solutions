# Project Euler 671 Solution - Colouring a Loop

<https://projecteuler.net/problem=671>:

* [671.py](671.py)

## Key ideas
- Model a boundary between columns with a small state capturing tile continuity, the previous column being a vertical domino, and the colours on the two boundary cells.
- Use colour symmetry: treat fixed distinguished colours (A for equal case, A/B for different case) and use canonical labels for “other” colours, which limits the number of states.
- Build a transfer matrix for one column step using local rules:
  - adjacency constraints between tiles
  - the no-four-corners rule (forbids a cut in both rows when neither adjacent column is a vertical domino)
- For a loop, the cut position is arbitrary, so the raw trace-style count represents tilings with a marked boundary. Divide by `n` (modulo the prime) to obtain the unmarked loop count.
- Compute `T^n` by fast matrix exponentiation and sum the required diagonal entries for the equal and different boundary-colour cases.

## Complexity
- State counts are small (a few hundred at most), so dense matrix exponentiation in `O(S^3 log n)` is fast.
- All computations are done modulo `1_000_004_321`.
