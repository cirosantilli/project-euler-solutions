# Project Euler 369 Solution - Badugi

<https://projecteuler.net/problem=369>:

* [369.py](369.py)

This solution counts, for each `n` from 4 to 13, how many `n`-card selections from a standard 52‑card deck contain a **4‑card Badugi subset** (4 distinct suits and 4 distinct ranks), and sums these counts.

## Key ideas

### 1) Model as a small bipartite graph
Represent the deck as a `4 × 13` grid:

- left side: the **4 suits**
- right side: the **13 ranks**
- an edge `(suit, rank)` exists in the chosen set iff that card is selected

A 4‑card Badugi subset exists **iff** the chosen edges contain a **matching of size 4** that covers all suits (each suit matched to a *distinct* rank).

So the problem becomes: count edge subsets of size `n` in `K_{4,13}` that contain a perfect matching on the 4‑vertex side.

### 2) DP over ranks (columns), using “reachable suit-sets”
Process the 13 ranks one by one. For a given rank we may pick any subset of its 4 suit-cards (16 possibilities).

For matchings, each rank can contribute **at most one** matched suit (because the matching needs distinct ranks).  
We track which sets of suits can be matched so far:

- Let `reach` be a 16‑bit bitset over masks `0..15`.
- Bit `m` is 1 if there exists a matching using processed ranks covering exactly the suits in mask `m`.

Transition for a rank with available suit-set `S`:
- keep `reach` (don’t use this rank), and
- for every reachable mask `m`, add one new suit from `S \\ m` to get `m ∪ {suit}`.

After all 13 ranks, a Badugi subset exists exactly when mask `1111₂` (all suits) is reachable.

### 3) State compression
Although `reach` is a 16‑bit value (65,536 possibilities), only a tiny subset is attainable under these transitions.  
A BFS over the transition system finds just **68 reachable reach-states**, making the DP extremely fast.

### 4) Counting by hand size
The DP also tracks how many cards have been selected so far (only up to 13 are needed):

`dp[state][k] = number of ways to select k cards leading to this reach-state`.

Finally:

- `f(n)` is the sum of `dp[state][n]` over states where “all suits reachable” is true.
- The requested output is `sum_{n=4..13} f(n)`.

## Complexity
- States: 68
- Per rank: 16 choices
- Card counts tracked: 0..13

Overall work is on the order of `13 * 68 * 16 * 14`, which is tiny.

## Verification
The code includes asserts from the problem statement:

- `C(52, 5) = 2,598,960`
- `f(5) = 514,800`
