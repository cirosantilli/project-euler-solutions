# Project Euler 573 Solution - Unfair Race

<https://projecteuler.net/problem=573>:

* [573.py](573.py)

This implementation follows two tracks:

## 1) Reduce the race to exponentials and running averages

If the starting positions are sorted i.i.d. uniforms

- `0 = U(0) < U(1) < ... < U(n) < U(n+1) = 1`

then runner `k` starts at `U(k)` and runs at speed `k/n`, so its finish time is

- `T_k = n * (1 - U(k)) / k`.

A standard order-statistics fact is that the gaps
`U(1)-U(0), U(2)-U(1), ..., U(n+1)-U(n)`
have the same distribution as **independent exponentials normalized by their sum**.

After removing the common normalization factor, the winner becomes:

> Let `E_1, ..., E_n` be i.i.d. `Exp(1)` and `S_k = E_1 + ... + E_k`.  
> The winning runner is the `k` that minimizes the running average `B_k = S_k / k`.

So the task is to compute `E_n = E[argmin_{1..n} (S_k/k)]`.

## 2) Exact values for small `n` via a Poisson/DP polynomial

To assert the sample values in the problem statement, we compute exact `E_n` for `n ≤ 50`.

A key sub-probability is

- `R_m(y) = P(S_1 > y, S_2 > 2y, ..., S_m > m y)`.

Viewing `S_k` as the arrival times of a Poisson process, the event `S_i > i y` is equivalent to
`N(i y) ≤ i-1`, where `N(.)` is Poisson(1). The increments over length-`y` intervals are independent
`Poisson(y)`, which leads to a short DP that produces coefficients `a_j` such that

- `R_m(y) = exp(-m y) * Σ_{j=0}^{m-1} a_j y^j`.

Then the winner probability has a closed-form gamma integral (no numerical quadrature needed).

## 3) Large-`n` asymptotic for `n = 1_000_000`

For the required target (`n = 1,000,000`), an asymptotic expansion is far more efficient and
more than accurate enough for 4-decimal rounding:

- `E_n = sqrt(pi*n/2) - 1/3 + 1/(4*sqrt(2*pi*n)) + O(1/n)`.

The leading term corresponds to a Rayleigh-type scaling limit for the location of the minimum
after `sqrt(n)` scaling; the constant corrections come from a standard Euler–Maclaurin refinement.

## Running

```bash
python3 main.py
```

It prints the required value rounded to 4 decimals.
