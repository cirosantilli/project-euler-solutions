# Project Euler 785 Solution - Symmetric Diophantine Equation

<https://projecteuler.net/problem=785>:

* [785.py](785.py)

We solve the Diophantine equation

\[
15(x^2+y^2+z^2)=34(xy+yz+zx)
\]

for **primitive** solutions \((x,y,z)\) with

- \(1 \le x \le y \le z \le N\)
- \(\gcd(x,y,z)=1\)

and compute

\[
S(N)=\sum (x+y+z)
\]

---

## 1) Rewriting the quadratic form

Define

- \(s = x+y+z\)
- \(m = x^2+y^2+z^2 - xy-yz-zx\)

Then one can show the original equation is equivalent to:

\[
64m = 19s^2
\]

This immediately implies:

- \(s\) must be divisible by 8
- Let \(s = 8n\), then:

\[
m = 19n^2
\]

Also, every solution contributes:

\[
x+y+z = s = 8n
\]

So we only need to sum \(8n\) over all valid solutions.

---

## 2) Convert to a norm equation

Let:

- \(u = x-y\)
- \(v = y-z\)

Then:

\[
m = u^2 + uv + v^2
\]

So the condition becomes:

\[
u^2 + uv + v^2 = 19n^2
\]

This is exactly a norm form in the Eisenstein integers (a quadratic form of discriminant \(-3\)).

---

## 3) A clean integer parameterisation

A suitable parameterisation of all solutions is obtained from coprime integer pairs \((a,b)\),
leading to three quadratic forms:

\[
A = 2ab + 3b^2
\]
\[
B = 5a^2 - 2ab
\]
\[
C = 3a^2 - 8ab + 5b^2
\]

For each valid \((a,b)\), the triple \((A,B,C)\) (sorted) produces a solution \((x,y,z)\).

The sum is especially simple:

\[
A+B+C = 8(a^2-ab+b^2)
\]

So each solution contributes:

\[
x+y+z = 8(a^2-ab+b^2)
\]

---

## 4) Filtering the correct region efficiently

We impose:

- \(1 \le b < a\)
- \(\gcd(a,b)=1\)
- all of \(A,B,C\) must satisfy \(1 \le A,B,C \le N\)
- also \(C>0\) forces \(b < 3a/5\)

Each inequality gives a quadratic bound on \(b\), so for a fixed \(a\) we compute an
interval \([b_{\min}, b_{\max}]\) using integer square-roots (`math.isqrt`) and iterate only within it.

---

## 5) Primitive solutions and the “19” exception

For coprime \((a,b)\), the triple’s gcd can only be:

- 1 (primitive), or
- 19 (non-primitive)

So we reject exactly those where:

- \(A \equiv 0 \pmod{19}\) and \(B \equiv 0 \pmod{19}\)

(This implies \(C\) is also divisible by 19.)

---

## 6) Speed notes

- We iterate \(a \le \sqrt{N/3}\)
- For each \(a\), we compute tight bounds for \(b\)
- Instead of calling `gcd(a,b)` repeatedly, we precompute distinct prime factors of each `a`
  via a smallest-prime-factor sieve and test divisibility of `b`.

All operations remain integer-only and avoid any external libraries.

---
