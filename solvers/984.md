# Project Euler 984 - Knight-connected, horse-disjoint sets

## Main ideas

1. A connected horse-disjoint set can be described by 8 linear bounds:
   - `x` min/max,
   - `y` min/max,
   - `(x+y)` min/max,
   - `(x-y)` min/max.
   This gives a discrete octagon-like shape inside a bounding box.

2. Use a canonical representation per bounding box `(W, H)`:
   - shape touches all 4 sides,
   - four corner-cut parameters `(p, q, c, d)` define the diagonal constraints.

3. For each canonical shape:
   - build its occupancy bitmask,
   - test knight-connectivity via DFS on the knight graph (also bitmask-based).

4. Let `g(W,H)` be the number of connected canonical shapes in a `W x H` box.
   Then
   - `f(N) = sum_{W<=N,H<=N} (N-W+1)(N-H+1) * g(W,H)`.

5. Compute exact `f(N)` for `N <= 20` and verify the statement samples:
   - `f(3)=9`, `f(5)=903`.

6. Empirically (and validated by the two large provided checks), for even `N >= 4`, `f(N)` is a degree-8 polynomial.
   - Interpolate from even points `N = 4,6,...,20`.
   - Validate:
     - `f(100) = 8658918531876`,
     - `f(10000) mod (1e9+7) = 377956308`.

7. Evaluate that polynomial at `N = 10^18` modulo `1e9+7`.

## Complexity

- Precomputation up to `N=20` dominates runtime.
- The implementation is optimized with:
  - symmetry `g(W,H)=g(H,W)`,
  - bitmask occupancy and bitmask DFS,
  - fast side-feasibility pruning before connectivity checks.
- Memory use is small (well below the 32 GiB limit).
