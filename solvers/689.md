# Project Euler 689 Solution - Binary Series

<https://projecteuler.net/problem=689>:

* [689.py](689.py)

This repository contains a standalone solution (`main.py`) for Project Euler problem 689.

## Key ideas used

### 1) Probabilistic reformulation
For a uniformly random `x ∈ [0,1)`, the binary digits after the point behave like independent fair bits (except for dyadic rationals, which have measure zero and do not affect the probability).

So the random value

\[
f(x) = \sum_{i\ge 1} \frac{d_i(x)}{i^2}
\]

has the same distribution as

\[
S = \sum_{i\ge 1} \frac{B_i}{i^2},
\]

where each \(B_i\) is an independent Bernoulli(1/2) random variable.

The goal is to compute \(P(S > 0.5)\).

### 2) Characteristic function factorization
The characteristic function of `S` is:

\[
\varphi(t) = \mathbb{E}[e^{itS}]
           = \prod_{i\ge 1} \frac{1 + e^{it/i^2}}{2}
           = e^{it\mu}\prod_{i\ge 1}\cos\left(\frac{t}{2i^2}\right),
\]

with mean \(\mu = \mathbb{E}[S] = \frac{1}{2}\sum_{i\ge 1}\frac{1}{i^2} = \pi^2/12\).

This turns the infinite product into a simple loop over cosine factors.

### 3) CDF / tail probability via inversion (Gil–Pelaez)
Using the Gil–Pelaez inversion formula, the tail probability can be written as:

\[
P(S > a)
= \frac{1}{2} + \frac{1}{\pi}\int_{0}^{\infty}
\frac{\sin((\mu-a)t)}{t}\prod_{i\ge 1}\cos\left(\frac{t}{2i^2}\right)\,dt.
\]

For \(a = 0.5\), this becomes a single real-valued integral.

### 4) Truncating the infinite product with a controlled tail correction
The cosine product is truncated at some `N`:

\[
\prod_{i\ge 1}\cos\left(\frac{t}{2i^2}\right)
\approx
\left(\prod_{i=1}^{N}\cos\left(\frac{t}{2i^2}\right)\right)
\cdot
\exp\left(-\frac{t^2}{8}\sum_{i>N}\frac{1}{i^4}\right),
\]

using `log(cos x) ≈ -x²/2` for small `x`.

The remaining sum is computed as `ζ(4) − Σ_{i≤N} 1/i⁴` with `ζ(4) = π⁴/90`.

### 5) Numerical integration with adaptive Simpson’s rule
The final integral is computed with an **adaptive Simpson** integrator (implemented iteratively with a stack):

- subdivides intervals until the Simpson error estimate falls below a requested tolerance,
- reuses already-computed function values at endpoints and midpoints to reduce work.

The program then prints the probability rounded to **8 digits after the decimal point**, as requested by Project Euler.
