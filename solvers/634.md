# Project Euler 634 Solution - Numbers of the Form $a^2b^3$

<https://projecteuler.net/problem=634>:

* [634.py](634.py)

We need to count integers `x ≤ n` that **can be expressed** as:

\[
x = a^2 b^3 \quad\text{with}\quad a>1,\; b>1
\]

The key is to reason about prime exponents.

## 1) Exponent decomposition

Write the prime factorisation:

\[
x = \prod p^{e_p}
\]

In any representation `x = a^2 b^3`, each exponent must split as:

\[
e_p = 2i_p + 3j_p \quad (i_p,j_p \ge 0)
\]

Because the nonnegative combinations of `2` and `3` produce every integer **except 1**, the condition is:

- `e_p` is never `1` for any prime `p`.

Numbers with all prime exponents ≥ 2 are called **powerful numbers**.

## 2) Counting all powerful numbers using a unique form

Every powerful number has a **unique** representation:

\[
x = A^2 B^3 \quad \text{where } B \text{ is squarefree and } A \ge 1
\]

(For each prime exponent `e`, take `j = e mod 2` so `B` contains each prime at most once.)

So the number of powerful numbers `P(n)` is:

\[
P(n) = \sum_{\substack{B \le \sqrt[3]{n} \\ B\ \text{squarefree}}}
\left\lfloor \sqrt{\frac{n}{B^3}} \right\rfloor
\]

We sieve squarefree `B` up to `⌊n^{1/3}⌋` (about 2.1 million for `9×10^18`) and sum integer square roots.

## 3) Subtract the powerful numbers that *cannot* use both `a>1` and `b>1`

Even if `x` is powerful, it might be impossible to make **both** parts nontrivial.

The only failing cases are:

1. **No cube contribution possible**  
   All exponents are in `{0,2,4}`  
   ⇔ `x = y^2` where `y` is **cubefree** (no prime cube divides `y`).

2. **No square contribution possible**  
   All exponents are in `{0,3}`  
   ⇔ `x = z^3` where `z` is **squarefree**.

3. **Prime sixth powers**  
   `x = p^6` for a prime `p`.  
   (Exponent `6` can be `2·3` or `3·2`, but never with both parts positive for a *single* prime.)

The first two sets overlap only at `x = 1`, and prime sixth powers are disjoint from both.

So:

\[
F(n) = P(n) - |X_1| - |X_2| - |X_3| + 1
\]

## 4) Efficient counting of the subtracted sets

- `|X2|` is just the count of squarefree integers `≤ ⌊n^{1/3}⌋` (from the same sieve).
- `|X3|` is `π(⌊n^{1/6}⌋)` (a tiny sieve up to ~1500).

The tricky part is `|X1| =` number of **cubefree** integers `≤ ⌊√n⌋`, and `√n` is ~3×10⁹ (too big to sieve).

Use Möbius inversion:

\[
\text{cubefree}(R) = \sum_{k=1}^{\lfloor R^{1/3}\rfloor} \mu(k)\left\lfloor \frac{R}{k^3}\right\rfloor
\]

Here `R = ⌊√n⌋`, and `R^{1/3}` is only about 1440, so we can compute `μ(k)` with a small linear sieve.

## Complexity

For `n = 9×10^18`:

- Squarefree sieve up to `n^{1/3}`: ~2.1 million
- Summation over squarefree `B`: ~1.27 million terms
- Cubefree count uses Möbius up to ~1440

Overall this runs comfortably fast in pure Python.
