# Project Euler 764 Solution - Asymmetric Diophantine Equation

<https://projecteuler.net/problem=764>:

* [764.py](764.py)

This solution computes

\[
S(N)=\sum (x+y+z)
\]

over all **primitive** integer solutions \((x,y,z)\) with

\[
16x^2+y^4=z^2,\qquad 1\le x,y,z\le N,\qquad \gcd(x,y,z)=1,
\]

and prints \(S(10^{16})\bmod 10^9\).

## 1) Turning the equation into a multiplicative form
Rewrite the equation as a difference of squares:

\[
z^2-(4x)^2=y^4 \;\Rightarrow\; (z-4x)(z+4x)=y^4.
\]

Let

* \(A=z-4x\)
* \(B=z+4x\)

Then \(AB=y^4\) and \(B-A=8x\).

For a **primitive** solution, any odd prime dividing both \(A\) and \(B\) would also divide \(x,y,z\), contradicting \(\gcd(x,y,z)=1\). Therefore \(\gcd(A,B)\) is a power of 2, and the **odd parts** of \(A\) and \(B\) must be perfect fourth powers.

So we can write (with \(p,q\) odd and coprime)

\[
A = 2^\alpha p^4,\qquad B = 2^\beta q^4,\qquad \alpha,\beta\ge 0,
\]

with the additional constraint \(\alpha+\beta\equiv 0\pmod 4\) so that \(AB\) is a fourth power.

From \(A,B\) we recover

\[
x = \frac{B-A}{8},\qquad z = \frac{A+B}{2},\qquad y = \sqrt[4]{AB}.
\]

## 2) 2-adic analysis: only two primitive families remain
A key observation is that primitive solutions force very specific 2-adic valuations:

* If \(\alpha=\beta\), the constraint \(\alpha+\beta\equiv 0\pmod 4\) implies \(\alpha\) is even.
  * For \(\alpha\ge 2\), \(x,y,z\) are all even \(\Rightarrow\) not primitive.
  * The only primitive equal-exponent case is \(\alpha=\beta=0\).

* If \(\alpha\ne\beta\), integrality of \(x\) forces \(\min(\alpha,\beta)\ge 3\).
  * If \(\min(\alpha,\beta)>3\) then \(x,y,z\) are all even.
  * The only primitive unequal-exponent cases have \(\min(\alpha,\beta)=3\) and the other exponent \(\equiv 1\pmod 4\).

This leaves exactly two primitive families:

### Family A (\(\alpha=\beta=0\))
\[
A=p^4,\; B=q^4\quad (p,q\text{ odd, coprime, }p<q)
\]
\[
x=\frac{q^4-p^4}{8},\quad y=pq,\quad z=\frac{p^4+q^4}{2}.
\]

### Family B (\(\min(\alpha,\beta)=3\), other \(=4k+1\))
Let \(k\ge 1\) and \(4k+1\) be the larger exponent.
There are two orientations depending on whether the \(2^3\) factor belongs to \(A\) or \(B\); both are handled.

## 3) Summing without iterating all pairs: Möbius inversion on coprimality
For each fixed odd base \(m\), we repeatedly need sums over odd integers \(t\) in a range with \(\gcd(t,m)=1\), such as:

* \(\sum 1\)
* \(\sum t\)
* \(\sum t^4\)

Coprimality is enforced via inclusion–exclusion over squarefree divisors using the Möbius function:

\[
\sum_{\substack{t\le L\\ \gcd(t,m)=1}} f(t)
= \sum_{d\mid m} \mu(d)\sum_{t\le L,\;d\mid t} f(t).
\]

Because we restrict to **odd** \(t\) and \(m\) is odd, multiples of an odd divisor \(d\) are odd iff the quotient is odd, so the inner sums reduce to closed forms over odd numbers.

## 4) Closed forms for sums over odd numbers
Write the odd numbers \(\le n\) as \(1,3,\dots,(2M-1)\) where \(M=\lfloor(n+1)/2\rfloor\).
Then:

* count: \(M\)
* sum of odds: \(1+3+\dots+(2M-1)=M^2\)
* sum of 4th powers: expand \((2i-1)^4\) and use standard polynomial power-sum formulas for \(\sum i,\sum i^2,\sum i^3,\sum i^4\).

These formulas make each range query \(O(2^{\omega(m)})\), where \(\omega(m)\) is the number of distinct prime factors of \(m\) (very small for \(m\lesssim 10^4\)).

## 5) Complexity
Let \(M\approx (2N)^{1/4}\). The program loops over odd parameters up to \(M\) and small \(k\) (up to about \(\log_2 M\)).
Each step enumerates only the squarefree divisors of the fixed base.

In practice, this runs very fast even for \(N=10^{16}\).

---

The file `main.py` contains:

* the derivation-based enumeration of primitive families,
* Möbius-based coprimality sums,
* asserts for the example values from the problem statement,
* and prints the required \(S(10^{16})\bmod 10^9\).
