# Project Euler 498 Solution - Remainder of Polynomial Division

<https://projecteuler.net/problem=498>:

* [498.py](498.py)

We are given:

- \(F_n(x) = x^n\)
- \(G_m(x) = (x-1)^m\)
- \(R_{n,m}(x)\) is the remainder when dividing \(F_n(x)\) by \(G_m(x)\)
- \(C(n,m,d)\) is the absolute value of the coefficient of \(x^d\) in \(R_{n,m}(x)\)

We need:

\[
C(10^{13}, 10^{12}, 10^4) \bmod 999999937
\]

## 1) Turning the remainder into a truncated Taylor series

Write \(x = 1 + (x-1)\):

\[
x^n = (1 + (x-1))^n = \sum_{k=0}^{n} \binom{n}{k}(x-1)^k
\]

Reducing modulo \((x-1)^m\) simply truncates the series:

\[
R_{n,m}(x) = \sum_{k=0}^{m-1} \binom{n}{k}(x-1)^k
\]

## 2) Extracting the coefficient of \(x^d\)

Expand \((x-1)^k\) into powers of \(x\):

\[
(x-1)^k = \sum_{j=0}^{k} \binom{k}{j} x^j (-1)^{k-j}
\]

So the coefficient of \(x^d\) in \(R_{n,m}(x)\) is:

\[
a_d = \sum_{k=d}^{m-1} \binom{n}{k}\binom{k}{d}(-1)^{k-d}
\]

Use \(\binom{n}{k}\binom{k}{d}=\binom{n}{d}\binom{n-d}{k-d}\), letting \(j=k-d\):

\[
a_d = \binom{n}{d}\sum_{j=0}^{m-1-d}(-1)^j\binom{n-d}{j}
\]

A standard identity for partial alternating binomial sums gives:

\[
\sum_{j=0}^{M}(-1)^j\binom{N}{j} = (-1)^M\binom{N-1}{M}
\]

With \(N=n-d\) and \(M=m-1-d\):

\[
a_d = (-1)^{m-1-d}\binom{n}{d}\binom{n-d-1}{m-d-1}
\]

Therefore:

\[
C(n,m,d) = |a_d| = \binom{n}{d}\binom{n-d-1}{m-d-1}
\]

(Notice the sign depends only on \(m\) and \(d\), not on \(n\).)

## 3) Computing huge binomials modulo a large prime (Lucas theorem)

The modulus \(p = 999999937\) is prime, but it is far too large to precompute factorials up to \(p-1\).

Lucas theorem solves this by working in base \(p\):

If \(n = \sum n_i p^i\) and \(k = \sum k_i p^i\), then

\[
\binom{n}{k}\equiv \prod_i \binom{n_i}{k_i}\pmod p
\]

For this problem, the base-\(p\) digits of the relevant numbers are *small* (e.g. \(10^{13}\) has remainder \(630000\) mod \(p\)), so we only need factorials up to about **630,000**, which is easy.

## 4) Complexity

- Factorials and inverse factorials up to ~630k: **O(630k)** time and memory.
- Lucas decomposition: only a couple of base-\(p\) digits: **O(number of digits)**.

This comfortably fits within typical limits.

---
Files:
- `main.py` — computes the answer and includes asserts for the statement’s examples.
