# Project Euler 484 Solution - Arithmetic Derivative

<https://projecteuler.net/problem=484>:

* [484.py](484.py)

We need

\[
S(N)=\sum_{1<k\le N} \gcd(k,k')
\]

where \(k'\) is the **arithmetic derivative** defined by

- \(p' = 1\) for prime \(p\)
- \((ab)' = a'b + ab'\) (Leibniz rule)

## Key ideas used

### 1) Work with \(g(n)=\gcd(n,n')\)

For a prime power \(p^a\):

\[
(p^a)' = a\,p^{a-1}
\]

so

\[
g(p^a)=\gcd(p^a, a\,p^{a-1}) = p^{a-1}\gcd(p,a)
=
\begin{cases}
p^{a-1} & p\nmid a\\
p^{a}   & p\mid a
\end{cases}
\]

A crucial fact for this problem is that \(g(n)\) is **multiplicative**.

### 2) Turn the sum into a divisor-sum (Dirichlet convolution)

Define (on prime powers)

\[
f(p^a)=g(p^a)-g(p^{a-1})
\]

Then (by telescoping on each prime power and multiplicativity)

\[
g(n)=\sum_{d\mid n} f(d)
\]

Therefore

\[
\sum_{n\le N} g(n)=\sum_{d\le N} f(d)\left\lfloor\frac{N}{d}\right\rfloor
\]

Finally, \(\gcd(1,1')=\gcd(1,0)=1\), so

\[
S(N)=\left(\sum_{n\le N} g(n)\right)-1
\]

### 3) Only *powerful* numbers contribute

Because \(g(p)=1\) and \(g(1)=1\), we have \(f(p)=0\).

Since \(f\) is multiplicative, any number with a prime exponent exactly 1 gets a zero factor.
So **only powerful numbers** (every prime exponent is 0 or \(\ge 2\)) contribute to the sum.

That dramatically reduces the search space.

### 4) DFS over primes and exponents with pruning

We enumerate powerful numbers implicitly:

- Choose the next prime \(p\)
- Walk over exponents \(a\ge 2\) while \(p^a\le\) current limit
- Add the contribution \(f(p^a)\cdot \left\lfloor N/(d\cdot p^a)\right\rfloor\)
- Recurse to larger primes to build products of prime powers

The implementation updates \(g(p^a)\) incrementally (and thus \(f(p^a)\)) without recomputing exponents from scratch.

### 5) Fast prime generation

We need primes up to \(\lfloor\sqrt{N}\rfloor\) (because any prime with exponent \(\ge 2\) must satisfy \(p^2\le N\)).

`main.py` uses an **odd-only sieve of Eratosthenes** with slice assignment for speed.

## Files

- `main.py` — runs the solver and prints the answer for \(N=5\cdot 10^{15}\)
- This `README.md` — explanation of the approach
