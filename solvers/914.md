# Project Euler 914 Solution - Triangles inside Circles

<https://projecteuler.net/problem=914>:

* [914.py](914.py)

## Key observations

- A **primitive Pythagorean triangle** is a right triangle with integer sides
  \(a^2+b^2=c^2\) and \(\gcd(a,b,c)=1\).
- A triangle fits *inside* a circle of radius \(R\) iff its **circumradius** is
  at most \(R\). The problem asks for *without touching*, so we need a strict
  inequality.
- For a right triangle, the circumradius is \(c/2\). Therefore
  \(c/2 < R \iff c < 2R\).

## Parametrising primitive triples

Every primitive Pythagorean triple can be written using Euclid’s formula:

\[
(a,b,c) = (m^2-n^2,\; 2mn,\; m^2+n^2)
\]

with integers \(m>n\), \(\gcd(m,n)=1\), and \(m-n\) odd.

For a right triangle, the inradius is

\[
r = \frac{a+b-c}{2}.
\]

Substituting Euclid’s formula simplifies this to a very clean form:

\[
r = n(m-n).
\]

So the task becomes:

- maximise \(n(m-n)\)
- subject to \(m^2+n^2 < 2R\), \(\gcd(m,n)=1\), \(m-n\) odd.

## Turning it into an efficient search

### 1) Maximise \(m\) for each \(n\)
For a fixed \(n\), the value \(r=n(m-n)\) increases as \(m\) increases.
So for each \(n\) we only need the **largest admissible** \(m\):

\[
m^2 \le (2R-1) - n^2 \quad\Rightarrow\quad m = \left\lfloor\sqrt{(2R-1)-n^2}\right\rfloor.
\]

Then we step down by 1 or 2 as needed to enforce:

- \(m-n\) odd (parity condition)
- \(\gcd(m,n)=1\) (primitiveness)

### 2) Only scan \(n\) near the optimum
Ignoring integrality, the maximum occurs when the triangle is “as close as
possible” to the continuous optimum. Solving the continuous optimisation gives
an approximate location

\[
n \approx \sqrt{\frac{R}{2+\sqrt{2}}}.
\]

The true integer maximiser lies extremely close to this value, so we scan a
small band around it, which keeps the runtime tiny even for \(R=10^{18}\).

## Complexity

Let \(W\) be the half-width of the scan band.

- The loop runs in \(O(W)\) iterations.
- Each iteration does a constant amount of work: one integer square root and a
  few gcd checks.

With a modest \(W\), this runs comfortably fast in pure Python.
