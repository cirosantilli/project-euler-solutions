# Project Euler 753 Solution - Fermat Equation

<https://projecteuler.net/problem=753>:

* [753.py](753.py)

This repository contains a fast, no-dependencies solution for computing

\[
\sum_{p<6\,000\,000,\ p\ \text{prime}} F(p),
\]

where \(F(p)\) counts ordered triples \((a,b,c)\) with \(1\le a,b,c<p\) satisfying

\[
a^3+b^3 \equiv c^3 \pmod p.
\]

## Main techniques

### Homogeneity (scale out \(c\))

Because the equation is homogeneous, for \(c\neq 0\) we can divide by \(c^3\) and write
\(x=a/c\), \(y=b/c\). Then

\[
a^3+b^3\equiv c^3 \iff x^3+y^3\equiv 1 \pmod p.
\]

Each nonzero \(c\) gives a distinct triple, so

\[
F(p) = (p-1)\cdot N(p),
\]

where \(N(p)\) is the number of solutions \((x,y)\in(\mathbb F_p^*)^2\) to \(x^3+y^3=1\).

### Split by \(p \bmod 3\)

- **\(p\equiv 2\ (\bmod 3)\):** the cube map is a bijection on \(\mathbb F_p^*\).
  Then every ordered pair \((a,b)\) works except when \(a^3+b^3\equiv 0\), which happens
  for exactly \(p-1\) pairs, giving

  \[
  F(p)=(p-1)(p-2).
  \]

- **\(p\equiv 1\ (\bmod 3)\):** cubes form an index-3 subgroup, and the count is tied to
  the **Fermat cubic** elliptic curve.

### Elliptic curve point counts via CM

The projective curve \(X^3+Y^3=Z^3\) is an elliptic curve with complex multiplication by
\(\mathbb Q(\sqrt{-3})\) (it has \(j=0\)). For primes \(p\neq 3\),

\[
\#E(\mathbb F_p)=p+1-a_p
\]

defines the Frobenius trace \(a_p\).

CM theory yields:

- If \(p\equiv 2\ (\bmod 3)\), then \(a_p=0\).
- If \(p\equiv 1\ (\bmod 3)\), there exist integers \(u,v\) such that

  \[
  4p = u^2 + 27v^2,\qquad |a_p|=u.
  \]

This curve has a rational 3-torsion point, so \(\#E(\mathbb F_p)\) is divisible by 3 for
every good prime \(p\neq 3\). Hence

\[
a_p \equiv p+1 \pmod 3.
\]

When \(p\equiv 1\ (\bmod 3)\), this forces \(a_p\equiv 2\ (\bmod 3)\), which fixes the sign.

Finally, for \(p\equiv 1\ (\bmod 3)\) one can show

\[
F(p) = (p-1)(\#E(\mathbb F_p)-9) = (p-1)(p-a_p-8).
\]

### Enumerating \((u,v)\) instead of modular square roots

With \(p < 6\cdot 10^6\), we have \(v \le \sqrt{4p/27} < 1000\), so we can enumerate all
integer pairs \((u,v)\) with \(u^2+27v^2 \le 4\cdot 5{,}999{,}999\), convert
\(p=(u^2+27v^2)/4\), and keep \(u\) whenever that \(p\) is prime and \(p\equiv 1\ (\bmod 3)\).

This builds a quick lookup table for \(u\) (hence \(a_p\)) for every relevant prime.

## Running

```bash
python3 main.py
