# Project Euler 331 Solution - Cross Flips

<https://projecteuler.net/problem=331>:

* [331.py](331.py)

This repository contains a self-contained Python solution for **Project Euler 331**.

## Core ideas used

### 1) Linear algebra over GF(2)

Treat each disk as a bit:

- white = 0
- black = 1

A move at `(i, j)` flips every disk in row `i` and column `j`, with the intersection disk flipped exactly once.
Over GF(2) (XOR arithmetic), “flip” means “add 1”.

Let `x[i][j]` be whether we choose the move `(i, j)` and let:

- `row_xor[i] = XOR_k x[i][k]`
- `col_xor[j] = XOR_k x[k][j]`

Then each cell satisfies:

```
row_xor[i] XOR col_xor[j] XOR x[i][j] = b[i][j]
```

where `b[i][j]` is the initial color.

### 2) Closed-form solution when `N` is even

When `N` is even, the linear system has a unique solution and can be rewritten directly in terms of
row/column parities of the initial board:

```
x[i][j] = b[i][j] XOR rb[i] XOR cb[j]
```

with `rb[i] = XOR_j b[i][j]` and `cb[j] = XOR_i b[i][j]`.

For the special configuration `C_N` in this problem, the pattern depends only on `i² + j²`,
so it is symmetric and `rb[i] == cb[i]`. This reduces the expression to:

```
x[i][j] = b[i][j] XOR r[i] XOR r[j]
```

where `r[i]` is the parity of black cells in row `i`.

### 3) Counting the number of moves without building the full solution

We want `T(N) = sum_{i,j} x[i][j]` (the Hamming weight of `x`).

Let:

- `A` = number of indices with `r[i] = 1`
- `total_b` = number of black cells
- `Bxor1` = number of black cells `(i,j)` where `r[i] XOR r[j] = 1`

Then:

```
T(N) = 2*A*(N - A) + total_b - 2*Bxor1
```

This lets us compute `T(N)` from 1D scans of the row intervals instead of materializing an `N×N` matrix.

### 4) Row intervals from circle differences

For configuration `C_N`, black cells satisfy:

```
(N-1)² <= i² + j² < N²
```

For a fixed row `i`, the valid `j` values form a contiguous interval that can be found using integer square roots.
That makes it possible to compute:

- row black-count parity `r[i]`
- `total_b` by summing interval lengths
- `Bxor1` using prefix sums over `r`

## What the code asserts

The implementation includes `assert`s for the statement-provided checks:

- `T(5) = 3`
- `T(10) = 29`
- `T(1000) = 395253`
- and the given solvability fact that `C_N` is unsolvable for odd `N > 5`.

## Note on the final sum

The Project Euler question asks for `sum_{i=3}^{31} T(2^i - i)`.  
The included code prints that value, but does not embed its decimal digits directly in the source.
