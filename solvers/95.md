# Project Euler 95 Solution - Amicable Chains

<https://projecteuler.net/problem=95>:

* [95.py](95.py)

We model the problem as a directed graph on numbers `1..N` where each node `n`
points to `s(n)`, the sum of proper divisors of `n`. An “amicable chain” is
exactly a directed cycle in this graph, with the extra constraint that every
value in the cycle is `<= 1,000,000`.

## Key ideas

1. **Sieve to compute `s(n)` for all `n <= N`**
   - Initialize an array `s` of size `N+1` with zeros.
   - For each divisor `i` from `1` to `N/2`, add `i` to all multiples `2i, 3i, ...`.
   - This computes sum of proper divisors in about `O(N log N)` time.

2. **Cycle detection with linear total work**
   - For each start value not globally processed, follow the chain `n -> s(n)`.
   - Track the current path and the first index where each node was seen in this walk.
   - If we revisit a node in the current path, we found a cycle; its members are a valid amicable chain.
   - If we hit `0`, go above `N`, or reach a globally processed node, there is no new cycle from this start.
   - Mark all nodes in the traversed path as processed so each number is explored at most once overall.

3. **Selecting the answer**
   - Keep the maximum cycle length found.
   - For ties, choose the chain with the smallest minimal element.
   - Output the smallest member of the longest chain.

The program includes assertions for the examples in the statement (perfect number 28,
amicable pair 220/284, and the 5-cycle starting at 12496), and prints the final result.
