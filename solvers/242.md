# Project Euler 242 Solution - Odd Triplets

<https://projecteuler.net/problem=242>:

* [242.py](242.py)

## Core idea

Let `f(n,k)` be the number of `k`-subsets of `{1,2,…,n}` whose element-sum is odd.  
We want to count **odd-triplets** `[n,k,f(n,k)]` where **all three values are odd**, with `n ≤ 10^12`.

A `k`-subset has an odd sum **iff** it contains an **odd number of odd elements**.

If `{1..n}` contains `O` odd numbers and `E` even numbers, then

`f(n,k) = Σ_{j odd} C(O,j) C(E,k-j)`.

## Working modulo 2 (parity) with Lucas / GF(2)

We only care whether `f(n,k)` is **odd**, i.e. `f(n,k) (mod 2) = 1`.

Over `mod 2`, Lucas’ theorem says:

`C(a,b)` is odd  **iff**  every 1-bit of `b` is also a 1-bit of `a`
(`b` is a bit-subset of `a`).

Using this and a GF(2) generating-function view, the parity collapses to a simple bit condition.

### Two key consequences

1. If `n ≡ 3 (mod 4)` then `O = (n+1)/2` is even, so `C(O,j)` is even for every odd `j`.  
   Therefore `f(n,k)` is **always even** → **no odd-triplets** for such `n`.

2. If `n = 4t + 1`, then `f(n,k)` (with `k` odd) is odd **iff**  
   **`(k-1)` is a bit-subset of `(n-1)`**.

So for each `n = 4t + 1`, the number of valid `k` equals the number of bit-subsets of `(n-1)`,
which is `2^{popcount(n-1)}`. Since `n-1 = 4t` is just `t` shifted left by 2, `popcount(n-1) = popcount(t)`.

Thus the total count for `n ≤ N` becomes:

`Σ_{t=0..T} 2^{popcount(t)}`, where `T = floor((N-1)/4)`.

## Fast summation: digit DP over bits

Define:

`F(T) = Σ_{x=0..T} 2^{popcount(x)}`.

For a complete block `0..(2^m - 1)`, each bit independently contributes either:
- factor `1` (bit = 0) or
- factor `2` (bit = 1),

so the block sum is `(1+2)^m = 3^m`.

For an arbitrary prefix:
- split at the top bit `2^m`,
- add the full block `3^m`,
- and recurse on the remainder, multiplying by `2` (since setting the top bit adds 1 to popcount).

This yields an `O(log T)` algorithm.

## Files

- `main.py`: computes the answer for `N=10^12` (or a provided `N`) and includes the statement’s sample asserts.
- `README.md`: this summary.
