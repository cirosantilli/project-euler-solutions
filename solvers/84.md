# Project Euler 84 Solution - Monopoly Odds

<https://projecteuler.net/problem=84>:

* [84.py](84.py)
* [84.lean](84.lean)

We want the long-run probability of *finishing* a roll on each Monopoly square, accounting for:

- 2 four-sided dice (or in the provided check: 2 six-sided dice)
- “Go To Jail” square
- Community Chest and Chance movement cards (uniform among 16 cards, with non-movement cards meaning “stay”)
- three consecutive doubles sending the player to jail
- ignoring “staying in jail” rules (player leaves jail immediately next turn)

### Key idea: Markov chain
Model the game as a Markov chain whose state is:

- `position` in `0..39`
- `consecutive_doubles` in `{0,1,2}`

So there are `40 * 3 = 120` states.

### Transitions
For each state and each dice outcome:

1. If it is the 3rd consecutive double, go directly to jail.
2. Otherwise move forward by the dice sum.
3. Apply square effects:
   - `G2J` sends directly to jail
   - `CC` has 2 movement cards (GO, JAIL)
   - `CH` has 10 movement cards (including “next railway”, “next utility”, and “go back 3”)
4. Some Chance moves can land on CC or G2J (e.g. “go back 3” from CH3), so effects are applied recursively until reaching a normal square.

When a player is **sent** to jail by a rule/card, the doubles counter resets to `0`. Merely landing on square 10 does not reset it.

### Stationary distribution
Compute the stationary distribution by power iteration on the 120-state transition graph, then sum the three doubles-states for each square.

Finally, sort squares by probability and output the top three as a concatenation of two-digit indices.

Result for 4-sided dice: `101524`.
