# Project Euler 262 Solution - Mountain Range

<https://projecteuler.net/problem=262>:

* [262.py](262.py)

This problem asks for the **shortest flight path** from  
**A(200,200)** to **B(1400,1400)** inside the square **0 ≤ x,y ≤ 1600**,  
where the mosquito must fly at a **constant elevation** `f`.

A point `(x,y)` is **flyable** iff `h(x,y) ≤ f`.  
We must:

1. Find `f_min` = the **minimum constant elevation** that allows *any* path from A to B.
2. Compute the **shortest path length** at that exact `f_min`, rounded to **3 decimals**.

---

## Key Techniques Used

### 1) “Flood Level” / Connectivity Threshold Insight
At a fixed elevation `f`, the *forbidden* region is:
- `h(x,y) > f`

As `f` increases, forbidden regions shrink.  
`f_min` occurs precisely when the free region first becomes connected between A and B.

For this landscape, that topological transition happens at a **boundary tangency**, so:

\[
f_{\min} = \max_{0\le y\le 1600} h(0,y)
\]

We compute it with:
- a coarse scan
- then a **golden-section search** refinement.

---

### 2) Tangency Points to the Critical Contour
At `f_min`, the shortest valid path touches the boundary of the forbidden region.

Let `F(x,y) = h(x,y) - f_min`.  
The obstacle boundary is the implicit curve:

\[
F(x,y)=0
\]

The shortest path is a standard “geodesic with obstacles” shape:
- straight segment from A to contour (must meet it tangentially)
- follow the contour
- straight segment from contour to B (also tangential)

Tangency condition at point `P` from origin `O`:

\[
\nabla h(P)\cdot (O-P) = 0
\]

So we solve the system:

- `h(x,y) = f_min`
- `∇h(x,y)·(O-(x,y)) = 0`

using **Newton’s method** (2D root solve, finite-difference Jacobian),
with multiple initial seeds to find all solutions.

We then discard tangency points that are not reachable by a straight segment in free space.

---

### 3) Arc-Length Integration Along an Implicit Curve
The contour segment must be traversed in the horizontal plane, so we need its **planar arc length**.

For `F(x,y)=0`, the gradient `∇F` is normal to the curve.  
A tangent direction is perpendicular to it:

\[
T = \frac{(-F_y, F_x)}{\|\nabla F\|}
\]

We integrate the ODE:

\[
\frac{d(x,y)}{ds} = T
\]

where `s` is arc length.

Implementation details:
- **RK4** (Runge–Kutta 4th order)
- periodic **projection back to the level set** (`h(x,y)=f_min`) to prevent drift
- adaptive step shrinking near the target point
- evaluate both directions around the contour and take the shorter arc

---

## Final Step
For each valid tangency pair `(P,Q)`:
- compute `|A-P|`
- compute arc-length along contour from `P` to `Q`
- compute `|Q-B|`
- take the minimum.

The program prints the result formatted to **3 decimals**.

Expected output:
