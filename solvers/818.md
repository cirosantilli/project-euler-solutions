# Project Euler 818 Solution - SET

<https://projecteuler.net/problem=818>:

* [818.py](818.py)

This solution models the SET® deck using finite geometry and computes the required 4th moment without enumerating card subsets.

## Key ideas

- **Affine-space model (`F₃⁴`)**  
  Each card is a 4-tuple over `{0,1,2}` (81 points total).  
  A “SET” is exactly an **affine line** of 3 points, i.e. `{a,b,c}` with `a+b+c=0` coordinate-wise in `F₃`.

- **Moment expansion**  
  For a fixed `n`-card subset `C`, let `S(C)` be the number of lines fully contained in `C`.  
  Expanding `S(C)^4` turns `F(n)=∑_C S(C)^4` into a sum over **ordered 4-tuples of lines**.
  A 4-tuple contributes to `F(n)` iff all cards in the **union** of those lines are in `C`, which depends only on the union size `k`:
  the number of `n`-subsets containing that union is `C(81-k, n-k)`.

- **Counting by union size (`A_k`)**  
  Let `A_k` be the number of ordered 4-tuples of lines whose union contains exactly `k` cards.
  Then:
F(n) = Σ_k A_k * C(81-k, n-k)

markdown
Copy code

- **Symmetry reduction via ordered line pairs**  
Instead of counting 4-tuples directly, the code splits them into two ordered pairs:
`(l1,l2)` and `(l3,l4)`.  
Ordered pairs of lines fall into only **four** affine-symmetry classes:
1. same line
2. intersecting lines
3. disjoint parallel lines
4. disjoint non-parallel (“skew”) lines

For each class, a representative pair has the same intersection statistics against all pairs in any other class.  
This lets us count all `A_k` values with just a few million fast bit operations.

## What the program does

1. Generates all 1080 lines (SETS) from point pairs using the “third card” rule.
2. Builds all ordered line pairs and groups them into the 4 symmetry classes.
3. Computes `A_k` (union-size counts) using class representatives.
4. Uses `F(n)=Σ_k A_k*C(81-k,n-k)` and asserts the given test values `F(3)` and `F(6)`.
5. Prints `F(12)`.

Run:
```bash
python3 main.py
yaml
Copy code

---

Again, download links:

- [Download main.py](sandbox:/mnt/data/main.py)  
- [Download README.md](sandbox:/mnt/data/README.md)
::contentReference[oaicite:0]{index=0}
 ​:contentReference[oaicite:1]{index=1}​
