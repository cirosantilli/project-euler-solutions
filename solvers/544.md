# Project Euler 544 Solution - Chromatic Conundrum

<https://projecteuler.net/problem=544>:

* [544.py](544.py)

This solution computes

- **F(r,c,n)**: number of proper colourings of an `r × c` grid with `n` colours (adjacent cells must differ),
- **S(r,c,n) = Σₖ₌₁..n F(r,c,k)** modulo **1,000,000,007**,

and answers `S(9,10,1112131415) mod 1e9+7`.

## 1) Chromatic polynomial via frontier (transfer) DP

For fixed `r,c`, `F(r,c,q)` is the **chromatic polynomial** of the grid graph evaluated at `q`.

We compute this polynomial directly using a **frontier dynamic program**:

- Sweep the grid **column-major** (width = `r`, which is only 9 here).
- Maintain the colours of the **frontier vertices** (the vertices that still have edges into the unprocessed part).

### Canonical colour labels (quotient by permutations)

Actual colour names don’t matter—only equality/inequality does—so a frontier colouring is stored **up to colour permutation**:

- Colours are relabelled `0,1,2,…` in the order they first appear on the frontier.
- Empty positions use a sentinel `-1`.

This reduces the number of frontier states dramatically (≈ a few thousand).

### Handling “new” colours symbolically

Let `m` be the number of distinct colour labels currently present on the frontier.

When colouring the next vertex:

- Reusing an existing label contributes **1 way**.
- Choosing a colour not currently present on the frontier contributes **(q − m)** ways.

So each DP value is a **polynomial in `q`**, and the only multiplication needed is by a linear term `(q − m)`.

## 2) Summing F(k) for huge n using polynomial interpolation

Because `F(q)` has degree `rc` (here 90), the prefix sum

`S(n) = Σₖ₌₁..n F(k)`

is a polynomial of degree `rc + 1` (here 91).

We compute `S(t)` for `t = 0..91` by evaluating `F(k)` for small `k`, then use **Lagrange interpolation** (with x-points `0,1,2,…`) to evaluate `S(1112131415)` modulo `1e9+7` in `O(91)` time.

## 3) Correctness checks

The program includes `assert`s for all example values from the statement:

- `F(2,2,3) = 18`
- `F(2,2,20) = 130340`
- `F(3,4,6) = 102923670`
- `S(4,4,15) mod (1e9+7) = 325951319`
