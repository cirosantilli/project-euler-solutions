# Project Euler 978 Solution - Random Walk Skewness

<https://projecteuler.net/problem=978>:

* [978.py](978.py)

# Random walk skewness (X₅₀)

## Key observation
The walk is defined by:

- `X₀ = 0`, `X₁ = 1`
- for `t ≥ 2`: `X_t = X_{t-1} ± |X_{t-2}|` (each direction with probability `1/2`)

Because `{+|x|, -|x|} = {+x, -x}` for any integer `x`, this process has the **same distribution** as the classic **random Fibonacci** recurrence:

\[
X_t = X_{t-1} + \varepsilon_t X_{t-2},\qquad \varepsilon_t \in \{-1,+1\},\; P(\varepsilon_t=\pm 1)=1/2,
\]

with independent signs `ε_t`.

## Moment recurrences
Let:

- \( \mu_t = \mathbb{E}[X_t] \)
- \( a_t = \mathbb{E}[X_t^2] \)
- \( m_t = \mathbb{E}[X_t^3] \)

Using independence of `ε_t` and the fact that \( \mathbb{E}[\varepsilon_t]=0 \):

### Mean
\[
\mu_t = \mathbb{E}[X_{t-1}] + \mathbb{E}[\varepsilon_t]\mathbb{E}[X_{t-2}] = \mu_{t-1}
\]
So for all \(t\ge 1\), \(\mu_t = 1\).

### Second moment
\[
X_t^2=(X_{t-1}+\varepsilon_t X_{t-2})^2
= X_{t-1}^2 + 2\varepsilon_t X_{t-1}X_{t-2}+X_{t-2}^2
\]
Taking expectation removes the cross term, giving:
\[
a_t = a_{t-1} + a_{t-2}
\]
with \(a_0=0\), \(a_1=1\).

### Third moment
\[
X_t^3=(X_{t-1}+\varepsilon_t X_{t-2})^3
= X_{t-1}^3 + 3\varepsilon_t X_{t-1}^2X_{t-2} + 3X_{t-1}X_{t-2}^2 + \varepsilon_t X_{t-2}^3
\]
Odd-`ε_t` terms vanish in expectation, leaving:
\[
m_t = m_{t-1} + 3\,\mathbb{E}[X_{t-1}X_{t-2}^2]
\]
But
\[
\mathbb{E}[X_t X_{t-1}^2]
= \mathbb{E}[(X_{t-1}+\varepsilon_t X_{t-2})X_{t-1}^2]
= \mathbb{E}[X_{t-1}^3]
\]
so \( \mathbb{E}[X_{t-1}X_{t-2}^2]=m_{t-2} \), yielding the closed recurrence:
\[
m_t = m_{t-1} + 3m_{t-2}
\]
with \(m_0=0\), \(m_1=1\).

## Skewness computation
For \(t\ge 2\), \(\mu=1\) and:

- variance: \( \sigma^2 = a_t - \mu^2 = a_t - 1 \)
- central third moment:
\[
\mathbb{E}[(X-\mu)^3] = m_t - 3a_t + 2
\]
- skewness:
\[
\mathrm{Skew}(X_t) = \frac{\mathbb{E}[(X-\mu)^3]}{\sigma^3}
\]

All raw moments are computed with **integer recurrences** in `O(t)` time.
The final division and square root use Python’s standard-library `decimal` module for stable rounding to 8 decimals.
