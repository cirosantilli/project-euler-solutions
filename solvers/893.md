# Project Euler 893 Solution - Matchsticks

<https://projecteuler.net/problem=893>:

* [893.py](893.py)

This solution is pure Python (standard library only).

## Model

- Decimal digits use standard 7-segment matchstick counts.
- `+` and `×` each cost 2 matchsticks.
- Operator precedence is standard (`×` binds tighter than `+`).

Define:

- `P(n)`: minimum sticks to display `n` using **digits and multiplication only**.
- `M(n)`: minimum sticks to display `n` using **digits, multiplication, and addition**.
- `T(N) = sum_{n=1..N} M(n)`.

## Technique 1: Digit-cost precomputation

For all `n <= N`:

digit_cost[n] = digit_cost[n // 10] + cost(last_digit)

python
Copy code

This is a single linear pass.

## Technique 2: Multiplication-only DP (`P(n)`) via SPF factorization

We compute:

P(n) = min(
digit_cost(n),
min_{d|n, 2<=d<=sqrt(n)} (P(d) + P(n/d) + 2)
)

r
Copy code

To enumerate divisors efficiently we build an SPF (smallest-prime-factor) sieve up to `N`,
factorize each `n` quickly, generate divisors from prime powers, and test divisor pairs.

`P(n)` is small for `n <= 10^6`, so it fits in a `bytearray`.

## Technique 3: Exact optimization for two additive terms

Any expression is a sum of multiplicative “terms”.
The solver first computes the exact optimum among:

- one term: `P(n)`
- two terms: `P(a) + P(b) + 2` with `a+b=n`

This is done with:
- cost buckets for `P(.)` and enumeration of all pairs producing strong improvements, and
- a fallback scan over low `P(a)` values for the few high-cost cases.

## Technique 4: Three-term improvement pass

Two-term optimization is almost sufficient, but there is a rare case where allowing
three terms (`a + b + c`) saves a matchstick.

A 3-term expression costs:

P(a) + P(b) + P(c) + 4

javascript
Copy code

We compute an auxiliary array:

- `best2[r] = min_{x+y=r} P(x)+P(y)` (stored only when this sum is small)

Then for candidate `n` we check whether `n = r + c` gives:

best2[r] + P(c) + 4 < M(n)

csharp
Copy code

This pass is applied only where `M(n)` is high enough that a 3-term improvement is possible.

## Running

```bash
python3 main.py
The program prints T(10^6).

The file includes asserts for the problem statement examples:

M(28) = 9

T(100) = 916

makefile
Copy code
