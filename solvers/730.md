# Project Euler 730 Solution - Shifted Pythagorean Triples

<https://projecteuler.net/problem=730>:

* [730.py](730.py)

This solution counts *primitive* integer triples \((p,q,r)\) with:

- \(p^2 + q^2 + k = r^2\)
- \(1 \le p \le q \le r\)
- \(p + q + r \le n\)
- \(\gcd(p,q,r)=1\)

Define \(P_k(n)\) as the number of such triples for a fixed \(k\), and
\(S(m,n)=\sum_{k=0}^{m} P_k(n)\).

The program computes \(S(100, 10^8)\) and prints the result.

## Main ideas

### 1) Invariant-preserving 3Ã—3 matrix generators

There are three integer matrices that preserve the quadratic form:

\[
p^2 + q^2 - r^2
\]

That means if a triple satisfies \(p^2 + q^2 + k = r^2\), then applying any of these matrices
produces another triple with the *same* \(k\).

So for each \(k\), the primitive solutions form a forest of trees:
start from a set of *roots* (seed triples), then repeatedly apply the three transforms to generate
all descendants.

### 2) Root detection using inverse transforms

To avoid duplicates (and to ensure the forest covers everything exactly once), we need the correct roots.

A triple is treated as a root if none of the three inverse matrices maps it back to a
strictly-positive ordered triple \((p,q,r)\) with \(p \le q \le r\).
Because the transforms are unimodular (determinant \(\pm 1\)), primitiveness is preserved along the tree.

### 3) Bounded enumeration of candidate roots

For \(k \le 100\), roots only occur with relatively small \(r\).
That allows generating all candidate triples in a small range of \((p,q,r)\), filtering by:

- the defining equation (via \(k = r^2 - p^2 - q^2\)),
- \(\gcd(p,q,r)=1\),
- and the "no positive parent" root test.

This finds all roots needed for \(k=0..100\) efficiently.

### 4) Depth-first traversal with pruning

For each root, the code performs an explicit stack-based depth-first traversal:

- Count the node if its perimeter \(p+q+r \le n\).
- Generate its children.
- Skip children whose perimeter already exceeds \(n\).

Perimeters of children are computed as fixed linear forms in \((p,q,r)\) to reduce overhead.

## Correctness checks

The program includes assertions for the sample values given in the problem statement:

- \(P_0(10^4)=703\)
- \(P_{20}(10^4)=1979\)
- \(S(10,10^4)=10956\)

These run automatically before the main computation.
