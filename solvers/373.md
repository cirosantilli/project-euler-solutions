# Project Euler 373 Solution - Circumscribed Circles

<https://projecteuler.net/problem=373>:

* [373.py](373.py)

This repo contains a pure-Python solution (no external libraries) for **Project Euler 373**.

## Core idea

Let `N(r)` be the number of integer-sided triangles whose **circumradius** is exactly `r`.
Then the asked value is

\[
S(n) = \sum_{r=1}^{n} r\,N(r).
\]

So the problem becomes: **given a radius `r`, how many integer-sided triangles have circumradius `r`?**

## Number theory reduction

A key observation is that integer chords in a circle of radius `r` correspond to **integer right triangles with hypotenuse `r`** (via half-chords / perpendiculars). Counting valid triangles for a fixed `r` can be reduced to counting suitable combinations of these chords.

This is governed by the classical theorem on representations of an integer as a **sum of two squares**:

- Only primes `p ≡ 1 (mod 4)` “split” in the Gaussian integers and create non-trivial representations.
- Primes `p ≡ 3 (mod 4)` and the prime `2` do not increase the variety in the same way (their contributions are “neutral” for this count).

If

\[
r = \prod p_i^{e_i} \cdot q
\]

where the `p_i` are exactly the primes with `p_i ≡ 1 (mod 4)` and `e_i` are their exponents in `r`, then the number of integer triangles with circumradius `r` is:

\[
N(r)=\frac{1}{6}\left(2\prod(3e_i^2+3e_i+1)-3\prod(2e_i+1)+3\prod(2\lfloor e_i/2\rfloor+1)-2\right).
\]

(Empty products are `1`.)

Finally:

\[
S(n)=\sum_{r=1}^{n} r\,N(r).
\]

## Implementation techniques

- **Linear sieve for smallest prime factors (SPF):** builds `spf[x]` for all `x ≤ n` in `O(n)` time.
- **Fast per-integer factorization:** each `r` is factorized by repeatedly dividing by `spf[r]`, extracting exponents `e_i`.
- **Only primes `≡ 1 (mod 4)` matter:** during factorization we multiply three small product terms only for those primes.
- **Low memory:** `spf` is stored as an `array('I')` (4 bytes per entry), ~40 MB for `n = 10^7`.

## Correctness checks

The code includes the problem statement checks:

- `S(100) = 4950`
- `S(1200) = 1653605`

and prints `S(10^7)` when run without arguments.
