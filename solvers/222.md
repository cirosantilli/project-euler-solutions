# Project Euler 222 Solution - Sphere Packing

<https://projecteuler.net/problem=222>:

* [222.py](222.py)

## Main ideas used

### 1) Reduce the 3D packing to 2D
Look at a cross-section plane through the pipe axis.  
Spheres become circles confined between two parallel lines (the pipe walls).

A sphere of radius `r` in a pipe of radius `R` has its center at most `R - r` away from the axis.

### 2) Compute the axial separation for two tangent balls
For two balls of radii `a` and `b`:

- Center distance (tangency): `a + b`
- To minimize pipe length, place them on opposite pipe walls, maximizing transverse separation:

`x = (R - a) + (R - b) = 2R - (a + b)`

Then the axial separation is the other leg of a right triangle:

\[
y = \sqrt{(a+b)^2 - x^2}
  = \sqrt{(a+b)^2 - (2R-(a+b))^2}
  = \sqrt{4R((a+b)-R)}
\]

With `R = 50` this matches the common simplified form
\[
y=\sqrt{200(a+b)-10000}.
\]

### 3) Total length for a fixed order
If the balls are arranged in an order `r0, r1, ..., rN-1` with adjacent pairs tangent, the pipe length is

\[
L = r_0 + r_{N-1} + \sum_{i=0}^{N-2} y(r_i, r_{i+1}).
\]

The answer is required in micrometres: `1 mm = 1000 µm`, rounded to the nearest integer.

### 4) Optimal ordering trick for this instance
For consecutive radii `30..50` with pipe radius `R=50`, the optimal order is:

- **descending evens**, then **ascending odds**  
  `50, 48, 46, ..., 30, 31, 33, ..., 49`

This places the two largest balls at the ends and alternates sizes in the way that minimizes the sum
of axial separations under the opposite-walls tangency model.

## Implementation details
- Uses `decimal.Decimal` at high precision to avoid floating-point rounding errors.
- Uses “round half up” when converting mm → µm.
- Includes internal sanity checks:
  - validates the distance formula,
  - brute-forces a few tiny toy instances to confirm the ordering construction,
  - checks the final placement has no overlaps under alternating-wall positioning.
