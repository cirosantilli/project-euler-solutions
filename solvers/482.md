# Project Euler 482 Solution - The Incenter of a Triangle

<https://projecteuler.net/problem=482>:

* [482.py](482.py)

We want all **integer-sided** triangles `ABC` whose incenter is `I` and for which the three vertex distances `IA`, `IB`, `IC` are integers.  
For each such triangle define:

- `p` = perimeter
- `L = p + IA + IB + IC`
- `S(P) = sum(L)` over all such triangles with `p ≤ P`

The problem asks for `S(10^7)` (and gives `S(10^3) = 3619`).

---

## 1) Tangency lengths and a right-triangle identity

Let `s = p/2` be the semiperimeter and define the standard tangency lengths

- `x = s - a`, `y = s - b`, `z = s - c`

where `a = BC`, `b = CA`, `c = AB`.  
Then the sides are:

- `a = y + z`
- `b = z + x`
- `c = x + y`

Drop perpendiculars from the incenter `I` to the sides. Each perpendicular has length equal to the inradius `r`. On side `AB`, the tangency point is at distance `x` from `A`. This creates a right triangle with legs `x` and `r`, hence:

- `IA^2 = x^2 + r^2`
- `IB^2 = y^2 + r^2`
- `IC^2 = z^2 + r^2`

So each `(r, x, IA)` is a (possibly non‑primitive) **Pythagorean triple**, and similarly for `y` and `z`.

---

## 2) The inradius is an integer

A key fact (and the reason the search becomes feasible) is:

> If the sides and `IA, IB, IC` are integers, then the inradius `r` is an integer.

A standard proof uses:
- the right-triangle equations above to show `4r^2` is an integer,
- a trigonometric/sine-rule argument to show `r` is rational,
- and a parity contradiction to rule out half-integers, forcing `r ∈ ℤ`.

So we only need to consider **integer** `r`.

---

## 3) Eliminating `r` using Heron’s formula

Heron’s formula gives area `K` by:

`K^2 = s(s-a)(s-b)(s-c) = sxyz`

but also `K = r s`. Therefore:

`(rs)^2 = sxyz  =>  r^2 = xyz / (x + y + z)`

Equivalently:

`xyz = r^2 (x + y + z)`.

This is the central diophantine condition connecting the three tangency lengths.

---

## 4) Solving for `z` from `x, y, r`

From `xyz = r^2(x + y + z)` we can isolate `z`:

`z(xy - r^2) = r^2(x + y)`

so

`z = r^2(x + y) / (xy - r^2)`.

Thus for a fixed inradius `r` and a chosen pair `(x, y)`, there is **at most one** candidate `z`.

---

## 5) Efficient enumeration

### Step A — generate all `(r, x, u)` Pythagorean pairs under bounds
For `P`, we have:

- `s = x + y + z ≤ P/2`
- thus `x, y, z ≤ s - 2`

We also bound `r` using the fact that for fixed `s`, `r` is maximized by an equilateral triangle:

`r ≤ s * sqrt(3) / 9`.

We generate all Pythagorean triples via Euclid’s formula:

- `a = m^2 - n^2`, `b = 2mn`, `c = m^2 + n^2` (primitive when `gcd(m,n)=1` and opposite parity)
- scale by `k`

We keep all scaled pairs where one leg is `r` (bounded) and the other leg is `x` (bounded).  
This produces, for each `r`, a small list of valid `x` values and their corresponding hypotenuse `u = sqrt(r^2 + x^2)`.

To avoid huge per-`r` Python structures, the implementation stores all pairs in flat arrays grouped by `r` using a CSR/prefix-sum layout.

### Step B — for each `r`, try all pairs `(x, y)`
For each `r`, we:

1. take its list of `x` values,
2. loop over `x ≤ y`,
3. compute `z` using the formula above,
4. check `z` exists in the same `r`-bucket,
5. check `x + y + z ≤ P/2`,
6. add `L = 2(x+y+z) + u(x) + u(y) + u(z)`.

We enforce `x ≤ y ≤ z` to count each triangle once.

---

## 6) Correctness check

The code includes the required statement example:

- `assert S(10^3) == 3619`.

---

## Result

Running `python3 main.py` prints:

- `S(10^7) = 1400824879147`.
