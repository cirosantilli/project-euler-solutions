# Project Euler 501 Solution - Eight Divisors

<https://projecteuler.net/problem=501>:

* [501.py](501.py)

We want the count of integers `n ≤ 10^12` that have **exactly 8 divisors**.

---

## 1) Divisor-count factorization patterns

If the prime factorization of `n` is:

\[
n = \prod p_i^{a_i}
\]

then the divisor count is:

\[
d(n) = \prod (a_i + 1)
\]

We need:

\[
d(n) = 8
\]

The only ways to write `8` as a product of integers `> 1` are:

- `8 = 8` → `n = p^7`
- `8 = 4×2` → `n = p^3 q` (distinct primes)
- `8 = 2×2×2` → `n = p q r` (three distinct primes)

So we count:

1. **p⁷ ≤ N**
2. **p³q ≤ N, p≠q**
3. **pqr ≤ N, distinct primes**

---

## 2) Counting with the prime counting function π(x)

To count primes under large bounds (up to about 1e11), we need the **prime counting function**:

\[
\pi(x) = \#\{p \le x : p \text{ prime}\}
\]

For small `x ≤ 10^6` we use a sieve table.
For larger values we use **Lehmer prime counting**.

---

## 3) Lehmer prime counting (key idea)

Lehmer computes π(n) using:

- a fast partial sieve function `φ(n, a)` that counts integers ≤ n not divisible
  by the first `a` primes.
- recursion on `π(n / p)` for primes `p`.

This is dramatically faster than sieving up to `n`.

---

## 4) Counting each divisor-form

### A) p⁷
Count primes `p ≤ N^(1/7)` → `π(N^(1/7))`.

### B) p³q
For each prime `p ≤ N^(1/3)`:

- `q ≤ N / p³`
- count = `π(N/p³)` minus 1 if `p` itself is included.

### C) p q r
Loop through `p < q` with constraint `p*q*q ≤ N`.
For each pair:

- `r ≤ N/(p*q)` and `r > q`
- count = `π(N/(p*q)) − π(q)`

---

## 5) Verification (asserts)

The solution includes asserts from the problem statement:

- f(100) = 10
- f(1000) = 180
- f(10^6) = 224427

---

## Output

Running `main.py` prints the answer for `N = 10^12`.
