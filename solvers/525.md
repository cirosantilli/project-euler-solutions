# Project Euler 525 Solution - Rolling Ellipse

<https://projecteuler.net/problem=525>:

* [525.py](525.py)

We need the length `C(a,b)` of the curve traced by the **center** of an ellipse

\[
\frac{x^2}{a^2}+\frac{(y-b)^2}{b^2}=1
\]

as the ellipse rolls (without slipping) along the x-axis for one complete turn.

The required output is:

\[
C(1,4)+C(3,4)
\]

rounded to 8 digits after the decimal point.

---

## Key ideas

### 1) Parameterize by the *contact point* on the ellipse

Use the standard ellipse parameter in its own (unrotated) frame:

\[
p(t) = (a\cos t,\; b\sin t)
\]

As the ellipse rolls, a different boundary point is in contact with the ground.
Over one complete roll, the contact parameter advances by \(2\pi\).  
We choose the start at the bottom point: \(t_0=-\pi/2\), integrate to \(t_0+2\pi\).

---

### 2) Tangency condition gives the rotation angle \(\theta(t)\)

At contact, the ground is horizontal, so the **tangent vector** at the contact point,
after rotating the ellipse by \(\theta\), must be horizontal.

The tangent in the ellipse frame is:

\[
p'(t)=(-a\sin t,\; b\cos t)
\]

Enforcing “rotated tangent has zero y-component” yields:

\[
\theta(t)=\operatorname{atan2}(b\cos t,\; a\sin t)-\pi
\]

Even better, differentiating \(\theta(t)\) gives a very clean expression:

\[
\theta'(t) = -\frac{ab}{a^2\sin^2 t + b^2\cos^2 t}
\]

---

### 3) No-slip condition: translation speed equals boundary speed

Rolling without slipping means the distance traveled along the x-axis equals the
arc length “unrolled” from the ellipse boundary.

The boundary speed is:

\[
s'(t) = |p'(t)| = \sqrt{a^2\sin^2 t + b^2\cos^2 t}
\]

So the ground contact point on the x-axis advances at rate \(s'(t)\).

---

### 4) Center velocity and arc length

Let \(R(\theta)\) be the rotation matrix and \(J\) be a 90° rotation operator
(\(J(x,y)=(-y,x)\)).

If the ground contact point is \((s(t),0)\), then the center is:

\[
C(t) = (s(t),0) - R(\theta(t))\,p(t)
\]

Differentiate:

\[
C'(t) = (s'(t),0) - R(\theta(t))\left(\theta'(t)\,Jp(t) + p'(t)\right)
\]

The desired length is the arc length:

\[
C(a,b)=\int_{t_0}^{t_0+2\pi} \left|C'(t)\right|\,dt
\]

---

### 5) Numerical integration (adaptive Simpson)

The final integral has a smooth periodic integrand but no simple closed form.
We compute it accurately using an **iterative adaptive Simpson** integrator with
tight tolerance (~\(10^{-12}\)).

A statement-provided check is included:

- \(C(2,4) \approx 21.38816906\)

---

## Result

Running `main.py` prints the value of:

\[
C(1,4)+C(3,4)
\]

rounded to 8 decimal places.
