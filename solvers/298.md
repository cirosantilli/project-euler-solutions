# Project Euler 298 Solution - Selective Amnesia

<https://projecteuler.net/problem=298>:

* [298.py](298.py)

This solution computes the expected value of \(|L-R|\) after 50 turns.

## Main techniques

### 1) Model the players as cache policies
- **Larry** behaves exactly like an **LRU cache** of capacity 5: on a hit, the item becomes most-recently-used; on a miss, insert and evict the least-recently-used.
- **Robin** behaves like a **FIFO cache** (queue) of capacity 5: hits do not change order; misses append and evict the oldest.

So a game state is fully described by two *ordered* memories:
- Larry: MRU → LRU
- Robin: oldest → newest

### 2) Symmetry reduction via canonicalization
The numbers 1…10 are i.i.d. and uniformly distributed, so the *labels* do not matter—only the **equality/overlap pattern** between the two memories does.

After each update, the state is **canonicalized** by renaming the distinct numbers that appear in either memory to `0..k-1` in deterministic “first-seen” order (scan Larry then Robin).  
All states that differ only by a permutation of labels collapse to the same canonical state.

This reduces the reachable Markov chain to **438 states** (including the empty state), making exact DP feasible.

### 3) Exact DP with integer sequence counts
Instead of floating probabilities, the DP carries **exact integer counts**:

- After `t` turns there are `10^t` equally likely call sequences.
- For each `(state, score_difference)` we store how many sequences lead there.

Each transition has probability `w/10` where `w` is the number of actual labels producing the same canonical transition (including the “absent number” bucket with weight `10-k`).  
Updating counts is just multiplying by small integers and adding—no rounding error.

### 4) Final expectation and rounding
After 50 turns:

\[
\mathbb{E}[|L-R|] = \frac{\sum_{d} |d| \cdot \#(d)}{10^{50}}
\]

Because the denominator is a power of 10, the value is an **exact terminating decimal**; we then round (half-up) to 8 decimal places.

## Output
Running `python3 main.py` prints the required 8-decimal answer.
