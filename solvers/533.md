# Project Euler 533 Solution - Minimum Values of the Carmichael Function

<https://projecteuler.net/problem=533>:

* [533.py](533.py)

## Key idea

The problem defines the Carmichael function `λ(n)` and:

- `L(n)` = the smallest `m` such that `λ(k) ≥ n` for **all** `k ≥ m`.

Let `X = n - 1`. Then:

- `L(n) = 1 + max { k : λ(k) ≤ X }`.

So we want the *largest* integer whose Carmichael value is at most `X`.

## Turning it into a maximization over `m`

For each `m`, define:

- `N(m)` = the largest integer `t` such that `λ(t)` **divides** `m`.

If `λ(t) | m` then certainly `λ(t) ≤ m`. Therefore:

- `max { k : λ(k) ≤ X } = max_{1 ≤ m ≤ X} N(m)`.

So the whole problem becomes: find `m ≤ X` that maximizes `N(m)`.

## Why `N(m)` is easy for a fixed `m`

Carmichael is multiplicative via lcm:
`λ(∏ p_i^{e_i}) = lcm( λ(p_i^{e_i}) )`.

For prime powers:

- Odd prime `p`: `λ(p^e) = (p - 1) p^{e-1}`.
- `2`: `λ(2)=1`, `λ(4)=2`, and for `e ≥ 3`, `λ(2^e)=2^{e-2}`.

For a fixed `m`, each prime can be treated independently:

- For odd `p`, you can include `p^e` in `N(m)` iff `(p-1)p^{e-1} | m`.
- That gives the maximum exponent:
  `e = 1 + v_p(m/(p-1))` when `(p-1)|m`, otherwise `e=0`.
- For `2`, the maximum exponent is:
  - `1` if `m` is odd
  - `v2(m) + 2` if `m` is even

So `N(m)` is uniquely determined by divisibility tests.

## Computing the best `m` via a sieve on logs

Directly computing `N(m)` for all `m ≤ X` is too big, but we only need to know which `m` wins.

We maximize `log(N(m))` (monotonic with `N(m)`):

- For every odd prime `p` and every “level”
  `step = (p-1)·p^t`, add `log(p)` to all multiples of `step`.
  This correctly counts the exponent `1 + v_p(m/(p-1))`.
- Handle the special `2`-power rule with two cheap loops over multiples of `2` and powers of two.

After building these log-scores for `m = 1..X`, a single scan finds the best `m`.

## Getting the final answer

Once the best `m` is known, compute `N(m)` **modulo** `10^9` by:

1. Factoring `m` and enumerating its divisors `d`.
2. Each divisor gives a candidate prime `p = d + 1`.
3. If `p` is prime, it contributes `p^(1 + v_p(m/d))` to `N(m)`.
4. Multiply also by the `2`-power contribution.
5. Finally `L(n) = N(m) + 1`, and we output the last 9 digits.

This matches the example values:

- `L(6) = 241`
- `L(100) = 20174525281`
