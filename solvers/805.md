# Project Euler 805 Solution - Shifted Multiples

<https://projecteuler.net/problem=805>:

* [805.py](805.py)

This solution computes **T(200) mod 1,000,000,007** for Project Euler problem 805.

## Key ideas

### 1) Turn the “digit shift” into algebra
Write a *k*-digit number as:

- `n = d · 10^(k-1) + x` where `d` is the leading digit (`1..9`) and `x` is the remaining `k-1` digits (possibly with leading zeros).

Shifting the first digit to the end gives:

- `s(n) = 10x + d`

The condition `s(n) = (a/b) · n` (with `a/b` reduced) becomes a linear equation in `x`, and it collapses to a clean closed form:

- Let `D = 10b − a`
- Then any solution must satisfy  
  `n = d · b · (10^k − 1) / D`

So every solution is a scaled “repunit” (`10^k−1`) divided by `D`.

### 2) Two separate constraints: integer divisibility + correct leading digit

**(A) Integer condition**

From  
`n = d · b · (10^k − 1) / D`  
we need `D | d·b·(10^k − 1)`.

Let  
`m = D / gcd(D, d·b)`.  
Then the condition becomes:

- `10^k ≡ 1 (mod m)`

So `k` must be a multiple of the multiplicative order of `10` modulo `m`.

If `gcd(m, 10) ≠ 1`, no such `k` exists (because `10^k−1` is never divisible by `2` or `5`).

**(B) Leading-digit condition**

The derivation assumes `d` is the *actual* leading digit. This translates into simple bounds on `10^(k-1)`:

- Lower bound: `a · 10^(k-1) ≥ b`
- Upper bound is only active when `a(d+1) > 10b`:
  `10^(k-1) < b·d / (a(d+1) − 10b)`

These bounds are fast to check and drastically prune impossible `(k, d)`.

### 3) Compute multiplicative order efficiently
To get `ord_m(10)`:

1. Factor `m` (here `m ≤ 80,000,000`, so trial division with primes up to ~9000 is enough).
2. Compute `φ(m)`.
3. Reduce a candidate order `k = φ(m)` by dividing out prime factors `p` while `10^(k/p) ≡ 1 (mod m)`.

Orders are memoized by `m` because many calls repeat.

### 4) Avoid huge integers; work modulo `1,000,000,007`
Once the minimal `(k, d)` is found, we only need:

`n mod MOD = d · b · (10^k − 1) · inv(D) (mod MOD)`

Since `MOD` is prime and `D < MOD`, `inv(D)` is just `D^(MOD−2) mod MOD`.

### 5) Summation for `T(200)`
Enumerate all ordered coprime pairs `(u, v)` with `1 ≤ u, v ≤ 200`, compute `a=u^3`, `b=v^3`, add `N(a/b)` modulo `MOD`.

The code includes `assert`s for all example values from the statement:
- `N(3)=142857`, `N(1/10)=10`, `N(2)=0`
- `T(3) ≡ 262429173 (mod 1,000,000,007)`
