# Project Euler 633 Solution - Square Prime Factors II

<https://projecteuler.net/problem=633>:

* [633.py](633.py)

This repository contains a reference solution for **Project Euler 633**.

The goal is to compute the limiting constant:

\[
c_k^{\infty}=\lim_{N\to\infty}\frac{C_k(N)}{N}
\]

where \(C_k(N)\) counts integers \(1\le n\le N\) having **exactly \(k\)** primes \(p\) for which \(p^2\mid n\) (“square prime factors”).

---

## Main ideas

### 1) Independence over primes (density factorization)

For a fixed prime \(p\), the density of integers divisible by \(p^2\) is \(1/p^2\).
In the limit as \(N\to\infty\), divisibility conditions for different primes factorize (Chinese remainder theorem / multiplicativity of densities).  
So the distribution of the number of square prime factors is encoded by the generating function:

\[
G(x)=\prod_{p}\Bigl(\bigl(1-\tfrac1{p^2}\bigr)+\tfrac1{p^2}x\Bigr)
\]

and the desired constant is:

\[
c_k^\infty = [x^k]\,G(x).
\]

---

### 2) Separating the squarefree part

Rewrite the factor for prime \(p\) as:

\[
\Bigl(1-\tfrac1{p^2}\Bigr)+\tfrac1{p^2}x
= \Bigl(1-\tfrac1{p^2}\Bigr)\Bigl(1 + \tfrac{x}{p^2-1}\Bigr).
\]

Multiplying over primes gives:

\[
G(x)=\underbrace{\prod_p\Bigl(1-\tfrac1{p^2}\Bigr)}_{=\,6/\pi^2}
\cdot
\prod_p\Bigl(1 + \tfrac{x}{p^2-1}\Bigr).
\]

Therefore

\[
c_k^\infty = \frac{6}{\pi^2}\cdot e_k\!\left(\frac{1}{p^2-1}\right),
\]

where \(e_k\) is the **\(k\)-th elementary symmetric sum** over all primes.

---

### 3) Computing \(e_k\) by small-degree polynomial DP

Let \(r_p = 1/(p^2-1)\). Then:

\[
\prod_p (1+r_p t) = \sum_{k\ge0} e_k(r_p)\,t^k.
\]

We only need \(k=7\), so we keep coefficients up to degree 7 and multiply one prime at a time:

- `coeff[0] = 1`
- for each prime \(p\):
  - for `j = 7..1`:
    - `coeff[j] += coeff[j-1] * r_p`

Using primes up to \(10^7\) makes the neglected tail far below the error needed for rounding to 5 significant digits.

---

## Built-in verification (asserts)

The solution includes asserts for **all numeric values given in the problem statement**:

- the square prime factors of 1500 are \(\{2,5\}\)
- the full table of \(C_k(10^n)\) for \(n=1..9\) and \(k=0..4\)

To compute these exact finite-\(N\) counts efficiently, it uses the bijection:

\[
n = a\cdot b^2,\quad \text{where }a\text{ is squarefree.}
\]

Then the number of square prime factors of \(n\) equals the number of distinct primes dividing \(b\).
Counting squarefree numbers uses Möbius inversion:

\[
Q(M)=\sum_{i\le\sqrt{M}} \mu(i)\left\lfloor\frac{M}{i^2}\right\rfloor.
\]

---

## Running

```bash
python3 main.py
```

It prints the final answer in the required scientific notation (5 significant digits).
