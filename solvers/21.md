# Project Euler 21 Solution - Amicable Numbers

<https://projecteuler.net/problem=21>:

* [21.py](21.py)

## Amicable Numbers (sum under 10000)

We need the sum of all numbers `a < 10000` such that there exists `b != a` with:
- `d(a) = b`
- `d(b) = a`
where `d(n)` is the sum of proper divisors of `n`.

### Key ideas
1. **Fast divisor-sum precomputation (sieve)**
   - Build an array `divsum[n]` for all `n < 10000`, where `divsum[n]` is the sum of proper divisors.
   - For each potential divisor `i`, add it to all multiples `2i, 3i, ...` (so it remains a proper divisor).

2. **Amicable check**
   - For each `a` from 2 to 9999:
     - compute `b = d(a)`
     - if `b != a` and `d(b) == a`, then `a` is amicable and is included in the total.
   - If `b` happens to be outside the sieve range, compute `d(b)` using prime factorization and the divisor-sum formula `sigma(n) - n`.

### Complexity
- Sieve computation: about `N log N` operations with `N = 10000` (very fast).
- Amicable checks: `O(N)` plus occasional factorization for out-of-range `b`.

The program prints the final sum: **31626**.
