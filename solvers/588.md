# Project Euler 588 Solution - Quintinomial Coefficients

<https://projecteuler.net/problem=588>:

* [588.py](588.py)

We want the number of **odd** coefficients in:

\[
(1+x+x^2+x^3+x^4)^k
\]

Let `Q(k)` be that count, and compute:

\[
\sum_{m=1}^{18} Q(10^m)
\]

## Main techniques

### 1) Work modulo 2 (GF(2))
A coefficient is odd iff it is `1` modulo `2`. So we do all polynomial reasoning in **GF(2)**.

### 2) Frobenius / binary exponent expansion
In GF(2), squaring is a simple substitution:

\[
f(x)^{2} = f(x^2)
\quad\Rightarrow\quad
f(x)^{2^i} = f(x^{2^i})
\]

Write \(k\) in binary: \(k = \sum b_i 2^i\). Then:

\[
(1+x+\dots+x^4)^k \equiv \prod_{i: b_i=1} (1+x^{2^i}+x^{2\cdot2^i}+x^{3\cdot2^i}+x^{4\cdot2^i}) \pmod 2
\]

So each `1`-bit of `k` contributes a “digit” \(d_i \in \{0,1,2,3,4\}\) at weight \(2^i\).

### 3) Carry automaton in base 2
For a fixed exponent \(n\), the coefficient parity equals the parity of the number of solutions to:

\[
n = \sum d_i 2^i, \quad d_i \in \{0,\dots,4\} \text{ if } k_i=1,\ \text{else } d_i=0
\]

Process bits from least-significant to most-significant. At bit position `i`, we only need the **carry**
from adding \(d_i\) (0..4) plus the incoming carry. Because the maximum digit is 4, the carry never
exceeds 3, so the carry state space is tiny: `{0,1,2,3}`.

We track a 4-component **parity vector** (mod 2) over carries, which has only \(2^4 = 16\) possibilities.
Transitions depend only on whether bit `i` of `k` is `0` (digit forced to 0) or `1` (digit 0..4 allowed).

### 4) Counting all exponents by DP over the 16 states
To get `Q(k)`, we count how many exponents `n` yield coefficient parity 1. Instead of iterating exponents,
we do a DP that branches on exponent bits (`0` or `1`) and counts how many bitstrings end in a state with
carry-0 parity equal to 1.

Runtime is \(O(16 \cdot \log k)\) per `Q(k)`, so computing all `Q(10^m)` for `m=1..18` is essentially instant.

## Files

- `main.py` — computes the required sum and prints it. Includes asserts for the provided test values.
- `README.md` — this explanation.
