# Project Euler 377 Solution - Sum of Digits - Experience #13

<https://projecteuler.net/problem=377>:

* [377.py](377.py)

We need the last 9 digits of:

\[
\sum_{i=1}^{17} f(13^i),
\]

where **`f(n)`** is the sum of all positive base-10 integers that:

- contain **no digit 0**, and
- have **digit sum = n**.

Example from the statement: `f(5) = 17891`.

---

## Key ideas

### 1) Turn “numbers” into “digit sequences”
A valid integer is exactly a sequence of digits `d1…dk` with each `di ∈ {1,…,9}` and:

\[
d_1 + d_2 + \cdots + d_k = n.
\]

So the problem is over **compositions of `n` with parts 1..9**.

### 2) Track an auxiliary function for lengths
When you prepend a digit `d` to a sequence `s` (length `L`):

- the new numeric value is `d·10^L + value(s)`.

That `10^L` forces us to also track:

\[
g(n) = \sum_{\text{sequences } s,\ \text{sum}(s)=n} 10^{\text{len}(s)}.
\]

### 3) Linear recurrences (order 9)
Splitting sequences by their first digit `d ∈ {1..9}` gives:

- **For `g`:**

\[
g(n)=10\,(g(n-1)+g(n-2)+\cdots+g(n-9)).
\]

- **For `f`:**

\[
f(n)=(f(n-1)+\cdots+f(n-9))+(1g(n-1)+2g(n-2)+\cdots+9g(n-9)).
\]

With base values:
- `g(0)=1` (empty sequence), `g(neg)=0`
- `f(0)=0`, `f(neg)=0`

All computations are done **modulo `10^9`** because only the last 9 digits are required.

### 4) Matrix exponentiation
Because `f(n)` and `g(n)` depend only on the previous 9 values, we store a state vector:

\[
V(n)=[g(n),g(n-1),...,g(n-8),\ f(n),f(n-1),...,f(n-8)]^T
\]

Then:

\[
V(n+1)=M\cdot V(n)
\]

for a fixed 18×18 matrix `M`. Using binary exponentiation, we compute `V(n)=M^n·V(0)` in `O(log n)` time.

This makes it practical to evaluate `f(13^i)` even for `i=17` (where `13^17` is about \(8.7\times 10^{18}\)).

---

## What the code does

1. Build the 18×18 transition matrix.
2. Precompute powers `M^(2^k)` for `k=0..63`.
3. For each needed `n`, apply the selected powers to the base vector `V(0)` (matrix–vector products).
4. Sum `f(13^i)` for `i=1..17` modulo `10^9`.
5. Assert the example `f(5)=17891`.

The final printed answer is `732385277`.
